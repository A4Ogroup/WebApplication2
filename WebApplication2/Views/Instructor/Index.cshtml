@inject LconsultDBContext _context
@{
    var courses = _context.Courses.OrderByDescending(c => c.AverageRating)
     .Take(10).ToList();

    var reviews = _context.Reviews.OrderByDescending(c => c.Rate)
            .Take(10).ToList();
}
<partial name="_NotificationPartial"></partial>
@{
    Layout = "_InstructorLayout";
}

<head>
    <style>

        <!-- review style-->
        .course-carousel3 {
            background-color: white;
            /*        background-color: gray;
                 */ padding: 20px;
            margin: 10px;
            margin-top: 0px;
            width: 95%;
            /*              max-width: 1200px;
                 */ border-radius: 8px;
            /*         box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
             */ position: relative;
        }

        .carousel-container3 {
            position: relative;
            overflow: hidden;
            width: 100%;
            padding-left: 0;
            padding-right: 0;
        }

        .carousel3 {
            min-width: 100%;
            display: flex;
            flex-wrap: nowrap;
            transition: 0.5s ease-in-out;
        }

        .course-card3 {
            flex: 0 0 auto;
            margin-right: 20px;
            text-align: left;
            background: #fff;
            border: 1px solid #eee;
            border-radius: 2px;
            padding: 15px;
            box-sizing: border-box;
        }

            .course-card3 img {
                width: 100%;
                height: auto;
                max-height: 150px;
                object-fit: cover;
            }

            .course-card3 h3 {
                font-size: 16px;
                margin: 10px 0;
            }

            .course-card3 p {
                margin: 5px 0;
                flex: 0 0 33.333%;
                box-sizing: border-box;
            }

        .arrow3 {
            position: absolute;
            top: 50%;
            width: 40px;
            height: 40px;
            background-color: #f1f1f6;
            color: #333;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transform: translateY(-50%);
            z-index: 1;
        }

            .arrow3.prev3 {
                left: 0;
            }

            .arrow3.next3 {
                right: 0;
            }

        @@media (max-width: 768px) {
            .course-card3 {
                max-width: calc(50% - 20px); /* Two cards to fit in a row */
            }
        }

        @@media (max-width: 480px) {
            .course-card3 {
                max-width: 100%; /* One card to fit in a row */
                margin-right: 0;
            }
        }

        .description {
            display: inline;
        }

        .more-text {
            display: none;
        }

        .see-more {
            color: blue;
            cursor: pointer;
        }


        <!-- review style end-->


        .course-carousel {
            background-color: white;
            /*        background-color: gray;
             */ padding: 20px;
            margin: 10px;
            margin-top: 0px;
            width: 95%;
            /*              max-width: 1200px;
             */ border-radius: 8px;
            /*         box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
         */ position: relative;
        }

        /* .course-carousel h2 {
                    margin-bottom: 20px;
                } */

        .carousel-container {
            position: relative;
            overflow: hidden;
            width: 100%;
            padding-left: 0;
            padding-right: 0;
        }

        .carousel {
            min-width: 100%;
            display: flex;
            /*             overflow: hidden;
             */ flex-wrap: nowrap;
            transition: 0.5s ease-in-out;
        }

        .course-card {
            min-width: auto; /*calc(100% / 3); */
            flex: 0 0 auto;
            /*             max-width: calc(33.333% - 20px); /* Three cards to fit in a row */
            margin-right: 20px;
            /*  margin-left:20px;
             */ text-align: left;
            background: #fff;
            border: 1px solid #eee;
            border-radius: 2px;
            padding: 15px;
            box-sizing: border-box;
        }

            .course-card img {
                width: 100%;
                height: auto;
                max-height: 150px;
                /*             border-radius: 5px;
         */ object-fit: cover;
            }

            .course-card h3 {
                font-size: 16px;
                margin: 10px 0;
            }

            .course-card p {
                margin: 5px 0;
                flex: 0 0 33.333%; /* Adjust based on how many cards you want to show at once */
                box-sizing: border-box;
            }

        .bestseller {
            background-color: #f4c150;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }

        .arrow {
            position: absolute;
            top: 50%;
            width: 40px;
            height: 40px;
            background-color: #f1f1f6;
            color: #333;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transform: translateY(-50%);
            z-index: 1;
        }

            .arrow.prev {
                left: 0;
            }

            .arrow.next {
                right: 0;
            }

        @@media (max-width: 768px) {
            .course-card {
                max-width: calc(50% - 20px); /* Two cards to fit in a row */
            }
        }

        @@media (max-width: 480px) {
            .course-card {
                max-width: 100%; /* One card to fit in a row */
                margin-right: 0;
            }
        }
    </style>
</head>
    <!-- Page Content -->
    <!-- Banner Starts Here -->
    <div class="banner header-text">
      <div class="owl-banner owl-carousel">
        <div class="banner-item-01">
          <div class="text-content">
            <h4>Best Courses</h4>
            <h2>Don not waste your time, search and find The best courses</h2>
          </div>
        </div>
      </div>
    </div>
    <!-- Banner Ends Here -->


<div class="latest-products">
    <div class="container">
        <div class="row">

            <div class="col-md-12">
                <div class="section-heading">
                    <h2>Top Courses</h2>
                    <a asp-controller="home" asp-action="course">view all courses <i class="fa fa-angle-right"></i></a>
                </div>
            </div>



            <div class="course-carousel">
                @*                     <h2>Top Rated Courses</h2>
                *@                    <div class="carousel-container">
                    <button class="arrow prev">&#10094;</button>
                    <div class="carousel">
                        @foreach (var course in courses)
                        {
                            <div class="course-card">
                                @if (@course.Picture is null)
                                {
                                    course.Picture = "noimage.png";

                                }<a href="#"><img src="~/images/courses/@course.Picture" alt=""></a>
                                <h3>@course.Title</h3>
                                <p>@course.InstructorFullName</p>
                                <p>
                                    @course.AverageRating
                                    @if (course.AverageRating > 4.0 && course.AverageRating <= 4.9)
                                    {
                                        <span class="fa fa-star" style="color:red;"><span class="fa fa-star-half-full"></span></span>
                                    }
                                    @if (course.AverageRating == 4.0)
                                    {
                                        <span class="stars" style="color:red;">★★★★</span>
                                    }
                                    @if (course.AverageRating > 3.0 && course.AverageRating <= 3.9)
                                    {
                                        <span class="stars" style="color:red;">★★★<span class="fa fa-star-half-full"></span></span>
                                    }
                                    @if (course.AverageRating == 3.0)
                                    {
                                        <span class="stars" style="color:red;">★★★</span>
                                    }
                                    @if (course.AverageRating < 3.0)
                                    {
                                        <span class="stars" style="color:red;">★★</span>
                                    }
                                    (@course.Reviews.Count().ToString())
                                </p>
                                <p></p>
                                @if (course.PriceStatus is true)
                                {
                                    <span>Paid</span>
                                }
                                else
                                {
                                    <sapn>Free</sapn>
                                }
                            </div>
                        }
                    </div>
                    <button class="arrow next">&#10095;</button>
                </div>
            </div>
        </div>
    </div>
</div>





<div class="latest-products">
    <div class="container">
        <div class="row">

            <div class="col-md-12">
                <div class="section-heading">
                    <h2>Reviews</h2>

                </div>
            </div>



            <div class="course-carousel3">
                <div class="carousel-container3">
                    <button class="arrow3 prev3">&#10094;</button>
                    <div class="carousel3">
                        @foreach (var review in reviews)
                        {
                            <div class="course-card3">

                                <strong>@review.Student</strong>
                                <span class="text-muted small">@review.GetFormattedDate(review.RatingDate.Value)</span>
                                <ul style="color:red;">


                                    @switch (review.Rate)
                                    {
                                        case 5:
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            break;
                                        case 4:
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            break;
                                        case 3:
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            break;
                                        case 2:
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            break;
                                        default:
                                            <i class="fa fa-star"></i>
                                            break;
                                    }
                                </ul>


                                @if (review.Descritipn.Length > 100)
                                {
                                    <p class="description">
                                        @review.Descritipn.Substring(0, 100)
                                        <span class="more-text">@review.Descritipn.Substring(100)</span>
                                        <span class="see-more">...See More</span>
                                    </p>
                                }
                                else
                                {
                                    <p class="description">@review.Descritipn</p>
                                }

                            </div>
                        }
                    </div>
                    <button class="arrow3 next3">&#10095;</button>
                </div>
            </div>


        </div>
    </div>
</div>





@section Scripts {

    <script>
        $(document).ready(function () {
            const slides = $(".carousel .course-card");
            let totalSlides = slides.length;
            let slideIndex = 0;

            function getVisibleSlides() {
                const screenWidth = $(window).width();
                if (screenWidth < 768) {
                    return 1;  // Show 1 card on very small screens
                } else if (screenWidth < 992) {
                    return 2;  // Show 2 cards on medium screens
                }
                return 3;  // Default to showing 3 cards on large screens
            }

            function setCarouselDimensions() {
                const visibleSlides = getVisibleSlides();
                const containerWidth = $(".carousel-container").width();
                const marginPerSlide = 20;
                const totalMargin = marginPerSlide * (visibleSlides - 1);
                const slideWidth = (containerWidth - totalMargin) / visibleSlides;

                slides.width(slideWidth - 32);  // Set each slide's width
                $(".carousel").width(slideWidth * totalSlides + totalMargin);  // Adjust total width of the carousel

                showSlides(slideIndex);  // Update display to current slide index
            }

            function showSlides(newIndex) {
                const slideWidth = slides.first().outerWidth(true);  // Get the actual width including margins
                const shift = -(slideWidth * newIndex);
                $(".carousel").css("transform", `translateX(${shift}px)`);
                slideIndex = newIndex;  // Update the global slideIndex
            }

            $(".arrow.next").click(function () {
                const visibleSlides = getVisibleSlides();
                if (slideIndex < totalSlides - visibleSlides) {
                    showSlides(slideIndex + 1);
                }
            });

            $(".arrow.prev").click(function () {
                if (slideIndex > 0) {
                    showSlides(slideIndex - 1);
                }
            });

            // Initialize carousel
            setCarouselDimensions();

            // Reinitialize carousel on window resize
            $(window).resize(setCarouselDimensions);
        });
    </script>


    <script>
        $(document).ready(function () {
            const slides = $(".carousel3 .course-card3");
            let totalSlides = slides.length;
            let slideIndex = 0;

            function getVisibleSlides() {
                const screenWidth = $(window).width();
                if (screenWidth < 768) {
                    return 1;  // Show 1 card on very small screens
                } else if (screenWidth < 992) {
                    return 2;  // Show 2 cards on medium screens
                }
                return 3;  // Default to showing 3 cards on large screens
            }

            function setCarouselDimensions() {
                const visibleSlides = getVisibleSlides();
                const containerWidth = $(".carousel-container3").width();
                const marginPerSlide = 20;
                const totalMargin = marginPerSlide * (visibleSlides - 1);
                const slideWidth = (containerWidth - totalMargin) / visibleSlides;

                slides.width(slideWidth - 32);  // Set each slide's width
                $(".carousel3").width(slideWidth * totalSlides + totalMargin);  // Adjust total width of the carousel

                showSlides(slideIndex);  // Update display to current slide index
            }

            function showSlides(newIndex) {
                const slideWidth = slides.first().outerWidth(true);  // Get the actual width including margins
                const shift = -(slideWidth * newIndex);
                $(".carousel3").css("transform", `translateX(${shift}px)`);
                slideIndex = newIndex;  // Update the global slideIndex
            }

            $(".arrow3.next3").click(function () {
                const visibleSlides = getVisibleSlides();
                if (slideIndex < totalSlides - visibleSlides) {
                    showSlides(slideIndex + 1);
                }
            });

            $(".arrow3.prev3").click(function () {
                if (slideIndex > 0) {
                    showSlides(slideIndex - 1);
                }
            });

            // Initialize carousel
            setCarouselDimensions();

            // Reinitialize carousel on window resize
            $(window).resize(setCarouselDimensions);

            // Toggle "See More" functionality
            $(".see-more").click(function () {
                const moreText = $(this).siblings(".more-text");
                if (moreText.is(":visible")) {
                    $(this).text("...See More");
                } else {
                    $(this).text("...See Less");
                }
                moreText.toggle();
            });

        });
    </script>



}